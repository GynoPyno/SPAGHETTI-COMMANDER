local version = tonumber( (string.gsub(string.gsub(GetVersion(), '1.5.', ''), '1.6.', '')) )

if version < 3652 then -- All versions below 3652 don't have buildin global icon support, so we need to insert the icons by our own function
    LOG('Total Mayhem: ['..string.gsub(debug.getinfo(1).source, ".*\\(.*.lua)", "%1")..', line:'..debug.getinfo(1).currentline..'] - Gameversion is older then 3652. Hooking "UIFile" to add our own unit icons')

local MyUnitIdTable = {
   brnt2htt3=true, -- Twister MK3 - (Heavy Armored Tank)
   brost1battleship=true, -- Undine Class - (Battleship)
   brmat2fig1=true, -- Firefly - (Stealth Fighter)
   brmt3exbm=true, -- Exemplar - (Experimental Battle Spiderbot)
   brnt1exmob=true, -- UnderTaker - (Advanced Assault Tank)
   brot1mt=true, -- Lintea MK1 - (Medium Tank)
   broat1exgs=true, -- Halcyon - (Advanced Gunship)
   brot3btbot=true, -- Paladin - (Illuminate Knight)
   brot2mt=true, -- Pumice - (Medium Tank)
   brpat2figbo=true, -- Uhthesinn - (Fighter)
   brot3coug=true, -- Cougar - (Experimental Light Mech)
   brot2exbm=true, -- Akuma - (Advanced Battle Mech)
   brmt3pdro=true, -- Agronar - (Rocket Defense System)
   brnt2potshot=true, -- Pot Shot - (Medium Artillery)
   brnt3shbm2=true, -- Mayhem IV - (Prototype Ultraheavy Battlemech)
   brmt2medm=true, -- Pyrite - (Advanced Riot Bot)
   brnt2pd2=true, -- Ace - (Heavy Point Defense)
   brot2exm2=true, -- Gonarch - (Advanced Battle Tank)
   brobt1hydeng=true, -- Mastermind - (HydroCarbon Engineering Station)
   brot2asb=true, -- Terminator - (Advanced Laser Bot)
   brmt2abt=true, -- Caminara MK2 - (Advanced Battle Tank)
   brnt3shbm=true, -- Mayhem II - (Experimental Heavy Battlemech)
   brnbt1hart=true, -- Mortimer - (Heavy Artillery Installation)
   brnst1battleship=true, -- Meridian Class - (Battleship)
   brnt2epd=true, -- Tower Boss MK2 - (Experimental Plasmacannon)
   brmt1expdt2=true, -- Pen MK2 - (Experimental Point Defense)
   brnt1advbot=true, -- Warden - (Advanced Battle Bot)
   brmt1at=true, -- Roach - (Assault Tank)
   brmt1ht=true, -- Scarab - (Heavy Tank)
   brot2epd=true, -- Functionality - (Experimental Point Defense)
   brnt3argus=true, -- Argus - (Experimental Battlemech)
   brnst2advbattleship=true, -- Refiner Class - (Advanced Battleship)
   brnt3advbtbot=true, -- Hurricane - (Advanced Battlemech)
   brpt1asta=true, -- Hethistle-ve - (Assault Tank)
   brmat2gunship=true, -- Intruder - (Advanced Gunship)
   brnt2ht=true, -- Twister MK2 - (Heavy Armored Tank)
   brobt1airst=true, -- Refresher - (Air Staging Facility)
   brot3aa=true, -- Tachylite - (Mobile Anti-Air)
   brpt1extank2=true, -- Yath-Us - (Advanced Assault Tank)
   brnt1extk=true, -- Thunderstrike - (Advanced Battle Tank)
   brnt2bt=true, -- Boxer - (Battle Tank)
   brpt1expbot=true, -- Thaam-Thuum - (Advanced Battle Bot)
   brmt3cloaker=true, -- Indigo - (Experimental Mobile Cloakfield Generator)
   broat3asup=true, -- Stinger - (Stealth Fighter)
   brmt3ava=true, -- Avalanche - (Prototype Ultraheavy Beetlebot)
   brmt3mcm2=true, -- MadCat II - (Experimental Heavy Assault Mech)
   brpt1pd=true, -- Hethula-Uttaus - (Heavy Point Defense)
   brot3pdro=true, -- Zheela mk2 - (Heavy Plasma Artillery Installation)
   brmt1mt=true, -- Razor - (Medium Tank)
   brnt3bt=true, -- Bull - (Battle Tank)
   brnt1mtt2=true, -- Marmor MK2 - (Medium Tank)
   brmt2epd=true, -- Anode - (Experimental Point Defense)
   brnt2exlm=true, -- Firestorm - (Advanced Light Assault Mech)
   brnt2exart=true, -- Big Jack - (Experimental Artillery Installation)
   brot1mtt3=true, -- Lintea MK3 - (Medium Tank)
   brmt1expd=true, -- Pen MK1 - (Experimental Point Defense)
   brmt3advbtbot=true, -- Consolidator - (Advanced Battle Bot)
   brnt1btt2=true, -- Totem MK2 - (Battle Tank)
   brnt2bm=true, -- Banshee - (Advanced Gatling Mech)
   brmt2pd=true, -- Sabertooth - (Heavy Point Defense)
   brot1mtt2=true, -- Lintea MK2 - (Medium Tank)
   brmt1btt2=true, -- Reaper MK2 - (Battle Tank)
   brpt3shbm=true, -- Thaez-Atha - (Experimental Mega Bot)
   brnst1artillery=true, -- Polestar Class - (Artilleryship)
   brmt3ml=true, -- Scarlet - (Rocket Battery)
   brmbt1airst=true, -- Irondale - (Air Staging Facility)
   brmt3ht=true, -- Carnage - (Medium Tank)
   brot1btt2a=true, -- Hervour MK1 - (Battle Tank)
   broat2exgs=true, -- Galaxy - (Advanced AA Gunship)
   brnat1advfig=true, -- Afterburner - (Advanced FighterBomber)
   brmat1intc=true, -- Velox - (Interceptor)
   brmt1pdt2=true, -- Coyote MK2 - (Heavy Point Defense)
   brmt3aa=true, -- Sentinel - (Mobile Anti-Air)
   brmat3asup=true, -- Cobra - (Multi-Purpose Fighter)
   brmt1bm2=true, -- Aes - (Light Battle Mech)
   brmt3bm2mk2=true, -- Destructor - (Heavy Battle Mech)
   brot3exm1=true, -- Granite - (Advanced Support Tank)
   brost2advbattleship=true, -- Magnetite Class - (Advanced Battleship)
   brmt1advnavygun=true, -- Spearhead - (Anti-Navy Defense)
   brnt3pdro=true, -- Rocket Pad - (Rocket Defense System)
   broat3pride=true, -- Illuminate Pride - (Prototype Flying Fortress)
   brnbt1airst=true, -- Refuel & Repair - (Air Staging Facility)
   brnbaafac=true, -- Sky-Force - (HydroCarbon Anti-Air Perimeter Control System)
   brpt1expd=true, -- Ve-Us - (Experimental Point Defense)
   brmt2bm=true, -- Cybermech - (Battle Mech)
   brnt1expdt2=true, -- Mayor MK2 - (Experimental Gatling Defense System)
   brmt3pd=true, -- Tripple Threat - (Heavy Point Defense)
   brnt2exm1=true, -- Jackhammer - (Advanced Assault Bot)
   brmbt1peri=true, -- Hacker - (HydroCarbon Perimeter Monitoring System)
   brnt3ow=true, -- Owens - (Advanced Long-Range Missile Mech)
   brot2ht=true, -- Gheel - (Heavy Hover Tank)
   brot1expd=true, -- Mizura - (Experimental Point Defense)
   brot1exmobart=true, -- Starfall - (Advanced Mobile Artillery)
   urb1107=true, -- Cabin - (Hydroelectric Power Generator)
   brpt3pd=true, -- Athaamla - (Heavy Point Defense)
   brot1btt2=true, -- Fate MK2 - (Advanced Battle Tank)
   brnt2exm2=true, -- Tomahawk - (Advanced Tactical Missile Launcher)
   brmt1extank=true, -- Talon - (Advanced Battle Tank)
   brmt3mcm4=true, -- MadCat IV - (Experimental Heavy Mech)
   brnbt1peri=true, -- Overlook - (HydroCarbon Perimeter Monitoring System)
   brmt2ht=true, -- Leeroy MK2 - (Heavy Armored Tank)
   brmt2st=true, -- Raider - (Stealth Tank)
   brot3ham=true, -- Uziel - (Experimental Medium Mech)
   brnt1advnavygun=true, -- Pulverizer - (Anti-Navy Defense)
   brmt1bt=true, -- Reaper MK1 - (Battle Tank)
   brnt1exm1=true, -- Kruger - (Advanced Assault Tank)
   brot3hm=true, -- Hydra - (Siege Mech)
   brnt1exart=true, -- Lumberjack - (Experimental Artillery Installation)
   brnt3doomsday=true, -- Doomsday - (Prototype Mobile Fortress)
   brnt3bat=true, -- Rampart - (Experimental Mobile Artillery)
   brpat1exgunship=true, -- Ia-Usla - (Advanced Gunship)
   brmt3rap=true, -- Raptor - (Assault Mech)
   brot1btt3=true, -- Hervour MK2 - (Battle Tank)
   brnt1mtt3=true, -- Marmor MK3 - (Medium Tank)
   brot1extank=true, -- Tridymite - (Advanced Battle Tank)
   brnt1hpdt2=true, -- Thug MK2 - (Heavy Point Defense)
   brnt1ht=true, -- Predator MK1 - (Heavy Tank)
   brnt1expd=true, -- Mayor MK1 - (Experimental Gatling Defense System)
   brmt2abtt3=true, -- Caminara MK3 - (Advanced Battle Tank)
   brmt1btt3=true, -- Reaper MK3 - (Battle Tank)
   brpt1advnavygun=true, -- Thuos-Thaamla - (Anti-Navy Defense)
   ueb1108=true, -- Munson - (Naval Mass Rig)
   brmt1beetle=true, -- Karakurt - (Advanced Assault Bot)
   brpat1advbomb=true, -- Vesinnee - (Advanced Bomber)
   brnt3perses=true, -- Perses - (Experimental Point Defense)
   brot3ml=true, -- Eruption - (Plasma Battery)
   brmt3vul=true, -- Vulture - (Experimental Medium Mech)
   urb1108=true, -- Palo - (Naval Mass Rig)
   brmt1exm1=true, -- LaserBot - (Advanced Light Mech)
   xsb1108=true, -- Cedro - (Naval Mass Rig)
   brot3bt2=true, -- Rhyolite II - (Battle Tank)
   brmt1bm=true, -- Aes Supporter - (Light Rocket Mech)
   broat2fibo=true, -- Twilight - (Fighter/Bomber)
   brnt1htt2=true, -- Predator MK2 - (Heavy Tank)
   brpt2expd=true, -- Heth-Athala - (Experimental Point Defense)
   brpt1bt=true, -- Hethaam - (Battle Tank)
   brpt2hvbot=true, -- Athusil - (Advanced Heavy Assault Bot)
   brmat2advbomber=true, -- Eagle-Eye - (Advanced Stealth Bomber)
   brost1destr=true, -- Chronos Class - (Destroyer)
   brnt1hpd=true, -- Thug MK1 - (Heavy Point Defense)
   brot1advnavygun=true, -- Warper - (Anti-Navy Defense)
   brot3shbm=true, -- Enforcer - (Experimental Heavy Assault Mech)
   brpt3bt=true, -- Hethaamah - (Battle Tank)
   brmat1exgs=true, -- Eclipse - (Advanced Gunship)
   brmt3lzt=true, -- Delusion - (Laser Tank)
   brnt3ml=true, -- Superfly - (Rocket Battery)
   brot3ncm2=true, -- NovaCat II - (Experimental Battle Mech)
   brpt1ht=true, -- Yenshavoh - (Heavy Tank)
   brot1lt=true, -- Aurora - (Light Tank)
   brost3bship=true, -- Lupen Class - (Advanced Battle Ship)
   brmt1advbot=true, -- Redhawk - (Advanced Battle Bot)
   brpt2btbot=true, -- Iltha - (Heavy Battle Bot)
   brot3hades=true, -- Hades - (Prototype Ultraheavy Battlebot)
   brot3bt=true, -- Rhyolite - (Battle Tank)
   brot1exm2=true, -- Crusader - (Advanced Assault Tank)
   brpbt1peri=true, -- Uyal Ha-Esel - (HydroCarbon Perimeter Monitoring System)
   brnt1htt3=true, -- Predator MK3 - (Heavy Tank)
   brnt1mt=true, -- Marmor MK1 - (Medium Tank)
   brpt3ml=true, -- Heth-Zthuha - (Thau Battery)
   brot2exth=true, -- Templar - (Advanced Tank Hunter)
   brnt2exmdf=true, -- Horizon - (Advanced Mobile Defense System)
   brmt2beetle=true, -- Argiope - (Advanced Mobile Artillery)
   brnt3abb=true, -- IronFist - (Armored Battle Bot)
   brpt1exm1=true, -- Othazyne - (Heavy Battle Bot)
   brmt2wildcat=true, -- WildCat - (Advanced Gatling Mech)
   brot1bt=true, -- Fate MK1 - (Advanced Battle Tank)
   brnat2fighter=true, -- Vortec - (Fighter)
   broat1intc=true, -- Musca - (Interceptor)
   brot3ncm=true, -- NovaCat - (Experimental Heavy Mech)
   uab1108=true, -- Redway - (Naval Mass Rig)
   brmat1advfig=true, -- Venom - (Combat Fighter)
   brot1hpd=true, -- Zpyker - (Heavy Point Defense)
   brobt1peri=true, -- Finther - (HydroCarbon Perimeter Monitoring System)
   brnat1intc=true, -- Pugnator - (Fighter)
   brnat3airsup=true, -- Falcon - (Stealth Fighter)
   brnt1bt=true, -- Totem MK1 - (Battle Tank)
   brnt3ht=true, -- Crawler - (Heavy Tank)
   brmt2htt3=true, -- Leeroy MK3 - (Heavy Armored Tank)
   broat1fig=true, -- Vaikana - (Fighter)
   brnat3bomber=true, -- Havoc - (Advanced Bomber)
   brmt1advart=true, -- Dominion - (Advanced Rapid-Fire Artillery)
   brnat1exgs=true, -- Imperium - (Advanced Gunship)
   brnt3blasp=true, -- Blood Asp - (Experimental Heavy Mech)
   brnt3shpd=true, -- Ex-Catalyst - (Super Heavy Point Defense)
   brmt3snake=true, -- Snakebite - (Prototype Battle Bot)
   brmt3garg=true, -- Gargantua - (Advanced Assault Bot)
   uab1107=true, -- Fordyce - (Hydroelectric Power Generator)
   brpt2exbot=true, -- Yenah-lao - (Advanced Battle Bot)
   brnt2sniper=true, -- Marksman - (Advanced Sniper Tank)
   broat3bomber=true, -- Valiant - (Advanced Bomber)
   brmt3bt=true, -- Demon - (Battle Tank)
   ueb1107=true, -- HPG X100 - (Hydroelectric Power Generator)
   brmt1pd=true, -- Coyote MK1 - (Heavy Point Defense)
   brnt3aa=true, -- Air Grinder - (Mobile Anti-Air)
   brmt3mcm=true, -- MadCat - (Experimental Heavy Mech)
   brpt1btbot=true, -- Tha-Yath - (Advanced AA Battle Bot)
   brnt2epdt3=true, -- Tower Boss MK3 - (Experimental Plasmacannon)
   xsb1107=true, -- Eruya-leatoh - (Hydroelectric Power Generator)
   brot1exm1=true, -- Quadrobot - (Advanced Assault Bot)
   brmst1destr=true, -- Charcaradon Class - (Destroyer)
   brot3shpd=true, -- Brute - (Super Heavy Point Defense)
   brmst1battlecruiser=true, -- Coelacanth Class - (Battlecruiser)
   brot3abb=true, -- Serval - (Armored Battle Bot)
   brpt1htt3=true, -- Hethaam MK3 - (Battle Tank)
}

    local IconPath = "/Mods/TotalMayhem"
    -- Adds icons to the engeneer/factory buildmenu
    local oldUIFile = UIFile
    function UIFile(filespec)
        local IconName = string.gsub(filespec,'_icon.dds','')
        IconName = string.gsub(IconName,'/icons/units/','')
        if MyUnitIdTable[IconName] then
            local curfile =  IconPath .. filespec
            return curfile
        end
        return oldUIFile(filespec)
    end

else
    LOG('Total Mayhem: ['..string.gsub(debug.getinfo(1).source, ".*\\(.*.lua)", "%1")..', line:'..debug.getinfo(1).currentline..'] - Gameversion is 3652 or newer. No need to insert the unit icons by our own function.')
end
